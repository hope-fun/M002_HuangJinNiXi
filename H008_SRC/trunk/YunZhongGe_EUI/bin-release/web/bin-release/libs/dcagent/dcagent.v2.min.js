(function(u,v){"object"===typeof exports&&"undefined"!==typeof module?v(exports):"function"===typeof define&&define.amd?define("DCAgent",["exports"],v):v(u.DCAgent={})})(this,function(u){function v(){}function V(a){return"function"===typeof a}function Va(a){var b,c;b=Date.now();c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c;c=(b+16*Math.random())%16|0;b=Math.floor(b/16);return"x"===a?c.toString(16):(c&7|8).toString(16)});return(a||"")+c.replace(/-/g,"").toUpperCase()}function Wa(a){var b,
c;for(b in a)c=a[b],a[b]=c;(2<=arguments.length?[].slice.call(arguments,1):[]).forEach(function(g){var e;e=[];for(b in g)c=g[b],e.push(a[b]=c);return e});return a}function l(a,b,c){if(V(a))try{return a.apply(b,c)}catch(g){m("attemp error for "+a.toString(),g.stack)}}function m(a,b){console.log("#DCAgent: "+a);b&&console.log(b)}function Xa(a){try{return a.setItem(".","."),a.removeItem("."),!0}catch(b){return!1}}function ga(a,b,c){if(!a||a&&a.length>=c)return a;c=Math.ceil(c-a.length)/b.length;c=void 0===
c?0:c;for(var g="",e=0;e<c;e+=1)g+=b;return a+g}function ha(a,b,c){return function(){Array.isArray(b)||(b=[b]);Array.isArray(c)||(c=[c]);var g,e;for(g=0;g<b.length;g+=1)if(e=b[g],!1===l(e,this,arguments))return;var d=l(a,this,arguments);if(!1===d)return!1;for(g=0;g<c.length;g+=1)e=c[g],l(e,this,arguments);return d}}function Ya(a){return a?(a=a.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/))&&a[3]:""}function k(a,b,c){b=void 0===b?0:b;1E21<=a&&(a=9.527E19);return f.parseInt(a,
void 0===c?10:c)||b}function W(a){return"undefined"!==typeof f[a]}function H(a,b){a=x(a);q.setItem(a,b);ia.set(a,b,3650);return b}function O(a){a=x(a);return q.getItem(a)||ia.get(a)}function x(a){if(X||Y===a)return a;d.appId||m("appid should not be empty when you are in native env");return d.appId+"."+a}function Za(a){var b=y.hash,c="!"+a,g="";if(b){var e=/![0-9A-Z]{32,128}/gi;(b=b.match(e))?(b=b[0].slice(1),a===b||O(ja)||(g=b),y.href=y.href.replace(e,c)):y.href+=c}else y.href+="#"+c;H(ja,g);return g}
function s(a){var b,c;b=Array.prototype.forEach;c=Array.prototype.map;this.each=function(a,c,d){if(null!==a)if(b&&a.forEach===b)a.forEach(c,d);else if(a.length===+a.length)for(var h=0,f=a.length;h<f&&c.call(d,a[h],h,a)!=={};h++);else for(h in a)if(a.hasOwnProperty(h)&&c.call(d,a[h],h,a)==={})break};this.map=function(a,b,d){var f=[];if(null==a)return f;if(c&&a.map===c)return a.map(b,d);this.each(a,function(a,c,g){f[f.length]=b.call(d,a,c,g)});return f};"object"===typeof a?(this.hasher=a.hasher,this.screen_resolution=
a.screen_resolution,this.screen_orientation=a.screen_orientation,this.canvas=a.canvas,this.ie_activex=a.ie_activex):"function"===typeof a&&(this.hasher=a)}function ka(a){return a+"?__deuid="+d.uid+"&__deappid="+d.appId}function la(a){a=x(a);try{var b=JSON.parse(q.getItem(a));return Array.isArray(b)?b:[]}catch(c){return q.removeItem(a),[]}}function $a(a,b){var c=la(b);Array.isArray(a)?a.forEach(function(a){return c.push(a)}):c.push(a);q.setItem(x(b),JSON.stringify(c))}function ab(){q.removeItem(x(I));
q.removeItem(x(J))}function bb(){f.addEventListener&&f.addEventListener("error",function(a){l(function(){if(C.isReportAllowed(a.filename)){C.count+=1;var b={};["colno","filename","lineno","message"].forEach(function(c){return b[c]=a[c]||"1"});var c=a.error||{};b.stack=encodeURIComponent(c.stack||c.stacktrace||"");b.type=c.name||"Error";b.timestamp=parseInt(a.timeStamp/1E3);if(V(d.getErrorScene)&&(c=l(d.getErrorScene,c,[a]))){if(c&&"[object Object]"===ma.call(c)){var g="",e;for(e in c)g+="\t"+e+"="+
c[e]+"\n";c=g}else c=String(c);b.stack+="\n\nError scene:\n"+encodeURIComponent(c)}F.updateStorageByKey(b,J)}})},!1)}function cb(){if(!D){D={ver:na};oa.split(",").forEach(function(a){D[a]=d.hasOwnProperty(a)?d[a]:""});for(var a in pa)D[a]=d[a]||pa[a],D[a]||0===D[a]||(D[a]="")}return D}function db(){var a=cb();a.accountId=d.accountId||d.uid;(qa+","+Z).split(",").forEach(function(b){a[b]=d.hasOwnProperty(b)?d[b]:""});return a}function ra(a){var b=sa();b.timeout=ta;b.open("POST",a.url,!0);b.setRequestHeader("Content-Type",
"text/plain; charset=UTF-8");var c=Date.now();b.onreadystatechange=function(){if(4===this.readyState){var b=200<=this.status&&300>this.status,e=Date.now()-c;l(b?a.success:a.error,this,[this,e]);l(a.complete,this,[this,e]);this.ontimeout=this.onreadystatechange=null}};b.ontimeout=function(){var b=Date.now()-c;l(a.error,this,[this,b,!0]);l(a.complete,this,[this,b]);this.ontimeout=this.onreadystatechange=null};b.send(JSON.stringify(a.data))}function eb(a){var b=new egret.URLLoader,c=Date.now();b.addEventListener(egret.Event.COMPLETE,
function(b){var g=Date.now()-c;b=b.target;l("success"===b.data?a.success:a.error,b,[b,g,g>=ta]);l(a.complete,b,[b,g])});var g=new egret.URLRequest(a.url);g.method=egret.URLRequestMethod.POST;g.data=JSON.stringify(a.data);b.load(g)}function ua(a,b){if(a.data){a.data.errorInfoList&&a.data.errorInfoList.length>C.max&&(m("sending too many errors, only "+C.max+" allowed"),a.data.errorInfoList=a.data.errorInfoList.slice(0,C.max));var c=Wa({headerInfo:db()},a.data);fb({url:gb+"//"+b,data:c,success:function(b,
c){l(a.success,b,[b,c])},error:function(b,c,d){K+=1;l(a.error,b,[b,c,d])},complete:function(b,c){E+=1;l(a.complete,b,[b,c])}});m("report data:",c)}}function hb(){if(P)return P;$+=1;if(!(4<$)){var a={egret:"egret",layabox:"layabox",cocos:"cc.game",impact:"ig",phaser:"Phaser",pixi:"PIXI",create:"createjs",three:"THREE",gameMaker:"asset_get_type",playCanvas:"pc.fw",turbulenz:"TurbulenzEngine",quintus:"Quintus",melon:"me.game",lychee:"lychee",wade:"wade.addSceneObject",crafty:"Crafty",lime:"lime.Scene",
enchant:"enchant",isogenic:"IgeEngine",gameclosure:"GC.Application",panda:"game.Scene",kiwi:"Kiwi",jaws:"jaws",sirius2d:"ss2d",collie:"collie",physics:"Physics",stage:"Stage.Anim",babylon:"BABYLON"},b;for(b in a){var c=a[b];if(-1<c.indexOf(".")){var c=c.split("."),d=f[c[0]];if(d&&d[c[1]])return P=b}else if(f[c])return P=b}}}function va(a,b,c,g){var e=parseInt(Date.now()/1E3)-d.loginTime||1;if(e>=ib||0>=e)m("illegal online time: "+e);else{var p={data:{onlineInfo:{loginTime:d.loginTime,onlineTime:e,
extendMap:{from:d.from,engine:hb()||"",app:d.app}},eventInfoList:a||[],errorInfoList:b||[]},success:g};c&&(p.data.userInfo=c);a=F.getStorageByKey(I);b=F.getStorageByKey(J);if(a.length||b.length)F.clear(),p.data.eventInfoList=p.data.eventInfoList.concat(a),p.data.errorInfoList=p.data.errorInfoList.concat(b),p.error=function(){m("report failed, restoring data to localStorage");F.updateStorageByKey(p.data.eventInfoList,I);F.updateStorageByKey(p.data.errorInfoList,J);l(g,0,arguments)};E&&0===E%d.network&&
p.data.eventInfoList.push({eventId:jb,eventMap:{succ:E-K,fail:K,total:E}});ua(p,ka(wa))}}function xa(a){ya&&n[ya]||va(0,0,0,a)}function kb(a,b){this.status="constructed";this.run=function(){Q(this.timer);this.status="running";l(a);var c=this;this.timer=R(function(){return c.run()},b)};this.stop=function(){this.status="stopped";Q(this.timer)}}function lb(a){if(d.uid){var b=ga(d.uid,za,Aa);a!==b&&(d.uid=b,m("do u know you are updating device id?"),H(aa,parseInt(Date.now()/1E3)),a=d.uid)}if(!a){var c;
try{if(r.realBrowser)c=(new mb({canvas:!0,screen_resolution:!0,ie_activex:!0})).get().toString();else if(r.engine.layabox){var g=layabox.getDeviceInfo()||{};c=(c=g.mac||g.idfa)&&c.replace(/[-_:=\s]+/g,"").toUpperCase()}}catch(e){c=null}c=ga(c,za,Aa);c||(c=Date.now().toString(36).toUpperCase(),c=Va(r.engine.egret?nb+c:r.engine.layabox?ob+c:r.engine.cocos?pb+c:qb+c));a=c}c=a;H(Y,c);return c}function rb(a){var b=O(Y),c=b?0:1,b=lb(b);d.uid=b;d.accountId=b;d.interval=1E3*Math.max(Ba,parseFloat(a.interval||
Ba));d.virus&&r.realBrowser&&(d.parentId=Za(b));d.errorReport&&(C.excludes=Array.isArray(a.excludes)?C.excludes.concat(a.excludes):[],bb());d.timer=new kb(xa,d.interval);d.timer.status="running";d.loginTime=parseInt(Date.now()/1E3);d.initTime=d.loginTime;b=O(aa);b||(b=d.loginTime,H(aa,b));d.createTime=parseInt(b);c=c?{actTime:b,regTime:b,parentId:d.parentId}:null;va([{eventId:sb,eventMap:{page:encodeURIComponent(r.realBrowser?y.pathname+y.search:"!")}}],0,c);R(function(){return d.timer.run()},d.interval);
tb(function(){var a=parseInt(Date.now()/1E3);H(Ca,a)});w.setUserOptions(a);w.inited=!0}function Da(a){a=x(a);try{var b=JSON.parse(q.getItem(a));return Array.isArray(b)?b:[]}catch(c){return q.removeItem(a),[]}}function ub(a,b){var c=Da(b);Array.isArray(a)?a.forEach(function(a){return c.push(a)}):c.push(a);q.setItem(x(b),JSON.stringify(c))}function vb(){q.removeItem(x(I));q.removeItem(x(J))}function t(a,b){if(!a)return m("invoke failed, missing eventId"),!1;2<arguments.length&&(b=arguments[2]);var c=
{};if(b&&"[object Object]"===ma.call(b))for(var d in b)c[d.replace("%","_")]="number"===typeof b[d]?b[d]:encodeURIComponent(b[d]);wb.updateStorageByKey({eventId:a,eventMap:c},I)}function Ea(a,b,c,g){var e=arguments;Z.split(",").forEach(function(a,b){return d[a]=e[b]||""});d.roleLevel=k(g)||1}function Fa(a){return function(){var b=w.getLoginStatus();if(0===b)return m("DCAgent.login needed"),!1;if(1===b){var c=[a];[].forEach.call(arguments,function(a){return c.push(a)});ba.push(c);return!1}}}function xb(){ba.forEach(function(a){return S[a.shift()].apply(0,
a)});ba.length=0}function Ga(){Q(Ha);var a=d.timer;a.stop();Ha=R(function(){a.run()},yb)}function Ia(){var a=!0===w.inited;a||m("DCAgent.init needed with an appid");return a}var Ja,Ka=0,w={getUserOptions:function(){return Ja},setUserOptions:function(a){Ja=JSON.stringify(a)},setLoginStatus:function(a){Ka=a},getLoginStatus:function(){return Ka}},ca=(0,eval)("this"),f=ca||{},n=ca.document||{},y=ca.location||{},ma=Object.prototype.toString,ya="hidden"in n?"hidden":"webkitHidden"in n?"webkitHidden":"mozHidden"in
n?"mozHidden":"msHidden"in n?"msHidden":null,d={age:0,gender:0,roleLevel:0,netType:3},r={get engine(){return G},get localStorage(){return zb},get realBrowser(){return X},get cookie(){return Ab}},La;if("function"===typeof n.createElement){var T=n.createElement("div");if(T&&"function"===typeof T.querySelector){T.innerHTML="<i></i>";var Ma=T.querySelector("i");La=!!Ma&&"I"===Ma.tagName}}var G={egret:W("egret"),layabox:W("layabox"),cocos:W("cc")&&cc.game},zb=!!f.localStorage||G.egret||G.cocos,X=La,Ab=
X&&"cookie"in n,aa="dcagent_create_time",nb="EGRET",ob="LAYA",pb="COCOS",qb="UE",ja="dcagent_parent_id",I="dcagent_client_events",J="dcagent_client_errors",Y="dcagent_client_id",Ca="dc_p_lo",wa="rd.gdatacube.net/dc/hh5/sync",za="0A",Aa=32,jb="DE_EVENT_OSS",ta=3E4,ib=172800,Ba=40,oa="appId,appVersion,brand,channel,customDeviceId,idfa,imei,lonLat,mac,netType,operator,osVersion,platform,simCardOp,uid",qa="accountId,accountType,age,gender,gameServer",Z="roleId,roleRace,roleClass,roleLevel",sb="DE_EVENT_PV",
yb=5E3,q;q=r.engine.egret?egret.localStorage:r.engine.cocos?cc.sys.localStorage:r.localStorage?f.localStorage:{getItem:v,setItem:v,removeItem:v};var Na,ia=Na=r.cookie?{get:function(a){return(a=n.cookie.match(new RegExp("(^|)\\s*"+a+"=([^\\s]*)")))&&3<=a.length?decodeURIComponent(a[2]):null},set:function(a,b,c,d,e,p){var f;c&&(f=new Date,f.setTime(f.getTime()+864E5*c));c=c?" expires="+f.toGMTString():"";e=" path="+(e||"/");d=d?" domain="+d:"";p=p?" secure":"";n.cookie=a+"="+encodeURIComponent(b)+c+
e+d+p},remove:function(a,b,c){Na.set(a,"",-1,b,c)}}:{get:v,set:v,remove:v},U={max:100,count:0,excludes:[],isReportAllowed:function(a){if(U.count<U.max)return U.excludes.every(function(b){return-1===a.indexOf(b)})}},C=U,z=f.screen,A=f.navigator;s.prototype.get=function(){var a=[];a.push(A.userAgent);a.push(A.language);a.push(z.colorDepth);if(this.screen_resolution){var b=this.getScreenResolution();"undefined"!==typeof b&&a.push(b.join("x"))}a.push((new Date).getTimezoneOffset());a.push(this.hasSessionStorage());
a.push(this.hasLocalStorage());a.push(!!f.indexedDB);n.body?a.push(typeof n.body.addBehavior):a.push("undefined");a.push(typeof f.openDatabase);a.push(A.cpuClass);a.push(A.platform);a.push(A.doNotTrack);a.push(this.getPluginsString());this.canvas&&this.isCanvasSupported()&&a.push(this.getCanvasFingerprint());return this.hasher?this.hasher(a.join("###"),31):this.murmurhash3_32_gc(a.join("###"),31)};s.prototype.murmurhash3_32_gc=function(a,b){var c,d,e,f,h;c=a.length&3;d=a.length-c;e=b;for(h=0;h<d;)f=
a.charCodeAt(h)&255|(a.charCodeAt(++h)&255)<<8|(a.charCodeAt(++h)&255)<<16|(a.charCodeAt(++h)&255)<<24,++h,f=3432918353*(f&65535)+((3432918353*(f>>>16)&65535)<<16)&4294967295,f=f<<15|f>>>17,f=461845907*(f&65535)+((461845907*(f>>>16)&65535)<<16)&4294967295,e^=f,e=e<<13|e>>>19,e=5*(e&65535)+((5*(e>>>16)&65535)<<16)&4294967295,e=(e&65535)+27492+(((e>>>16)+58964&65535)<<16);f=0;switch(c){case 3:a.charCodeAt(h+2);break;case 2:a.charCodeAt(h+1);break;case 1:f^=a.charCodeAt(h)&255,f=3432918353*(f&65535)+
((3432918353*(f>>>16)&65535)<<16)&4294967295,f=f<<15|f>>>17,e^=461845907*(f&65535)+((461845907*(f>>>16)&65535)<<16)&4294967295}e^=a.length;e^=e>>>16;e=2246822507*(e&65535)+((2246822507*(e>>>16)&65535)<<16)&4294967295;e^=e>>>13;e=3266489909*(e&65535)+((3266489909*(e>>>16)&65535)<<16)&4294967295;return(e^e>>>16)>>>0};s.prototype.hasLocalStorage=function(){try{return!!f.localStorage}catch(a){return!0}};s.prototype.hasSessionStorage=function(){try{return!!f.sessionStorage}catch(a){return!0}};s.prototype.isCanvasSupported=
function(){var a=n.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))};s.prototype.isIE=function(){return"Microsoft Internet Explorer"===A.appName||"Netscape"===A.appName&&/Trident/.test(A.userAgent)?!0:!1};s.prototype.getPluginsString=function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()};s.prototype.getRegularPluginsString=function(){return this.map(A.plugins,function(a){var b=this.map(a,function(a){return[a.type,a.suffixes].join("~")}).join(",");
return[a.name,a.description,b].join("::")},this).join(";")};s.prototype.getIEPluginsString=function(){return f.ActiveXObject?this.map("ShockwaveFlash.ShockwaveFlash;AcroPDF.PDF;PDF.PdfCtrl;QuickTime.QuickTime;rmocx.RealPlayer G2 Control;rmocx.RealPlayer G2 Control.1;RealPlayer.RealPlayer(tm) ActiveX Control (32-bit);RealVideo.RealVideo(tm) ActiveX Control (32-bit);RealPlayer;SWCtl.SWCtl;WMPlayer.OCX;AgControl.AgControl;Skype.Detection".split(";"),function(a){try{return new f.ActiveXObject(a),a}catch(b){return null}}).join(";"):
""};s.prototype.getScreenResolution=function(){return this.screen_orientation?z.height>z.width?[z.height,z.width]:[z.width,z.height]:[z.height,z.width]};s.prototype.getCanvasFingerprint=function(){var a=n.createElement("canvas"),b=a.getContext("2d");b.textBaseline="top";b.font="14px 'Arial'";b.textBaseline="alphabetic";b.fillStyle="#f60";b.fillRect(125,1,62,20);b.fillStyle="#069";b.fillText("http://www.dataeye.com/",2,15);b.fillStyle="rgba(102, 204, 0, 0.7)";b.fillText("http://www.dataeye.com/",4,
17);return a.toDataURL()};var mb=s,F={get getStorageByKey(){return la},get updateStorageByKey(){return $a},get clear(){return ab}},na=23;u.version=na;var pa={get resolution(){return L},get brand(){return Oa},get osVersion(){return Pa},get platform(){return M}},da=f.screen||{},L=da.width&&da.width+"*"+da.height,Oa,Pa,M=0;if(!f.navigator||!f.navigator.userAgent){var Qa=["ios","android"];if(G.layabox){var N=layabox.getDeviceInfo()||{},L=N.resolution||"0*0";Oa=N.phonemodel;M=Qa.indexOf(N.os.toLowerCase());
Pa=(N.os+" "+N.osversion).toLowerCase()}else if(G.cocos)var Ra=cc.view.getViewPortRect()||{},L=Ra.width+"*"+Ra.height,M=Qa.indexOf(cc.sys.os.toLowerCase());-1===[0,1,2,3].indexOf(M)&&(M=0)}L||(L="0*0");var D,sa=function(){return new f.XMLHttpRequest},fb=function(){if(f.XMLHttpRequest)return ra;if(r.engine.cocos)return sa=function(){return cc.loader.getXMLHttpRequest()},ra;if(r.engine.egret)return eb;m("XMLHttpRequest not found");return v}(),E=0,K=0,gb="https:"===y.protocol?"https:":"http:",P,$=0,
R=f.setTimeout,Q=f.clearTimeout;G.egret&&(R=function(a,b){egret.setTimeout(a,f,b)},Q=function(a){egret.clearTimeout(a)});var tb=function(a){if(f.addEventListener){var b;a:{b=["pagehide","beforeunload","unload"];for(var c=0;c<b.length;c+=1)if("on"+b[c]in f){b=b[c];break a}b=void 0}b&&f.addEventListener(b,a)}};u.init=function(a){Xa(q)?w.inited||(a=a||{},a.appId?(a.appId=a.appId.toUpperCase(),d.errorReport=!!a.errorReport,d.virus=!!a.virus,d.network="number"===typeof a.network?a.network:0,d.app=a.appName||
"",d.from=a.from||Ya(n.referrer),d.getErrorScene=a.getErrorScene,oa.split(",").forEach(function(b){a.hasOwnProperty(b)&&(d[b]=a[b])}),rb(a)):m("init failed, missing appId")):r.localStorage?m("localstorage qouta error, private mode?"):m("localstorage is not supported.")};var wb={get getStorageByKey(){return Da},get updateStorageByKey(){return ub},get clear(){return vb}},Bb={get initBasedAPI(){return ea},get loginBasedAPI(){return S},get cacheBeforeLogin(){return Fa},get clearLoginInvokeList(){return xb},
get asap(){return Ga},get checkInit(){return Ia}},ea={login:function(a){a?d.accountId===a?w.setLoginStatus(2):1===w.getLoginStatus()?m("cancel login, current login is not ready"):(d.timer.stop(),w.setLoginStatus(1),xa(function(){w.setLoginStatus(2);(qa+","+Z).split(",").forEach(function(a){return delete d[a]});d.age=0;d.gender=0;d.roleLevel=0;d.loginTime=parseInt(Date.now()/1E3);d.accountId=a;Bb.clearLoginInvokeList();d.timer.run()})):m("account is empty")},getUid:function(){return d.uid||""},onEvent:t},
S={createRole:function(a,b,c,d){Ea(a,b,c,d);t("DE_EVENT_CREATE_ROLE",{roleId:String(a),roleRace:String(b),roleClass:String(c)})},onCoinGet:function(a,b,c,d){t("DE_EVENT_COIN_ACTION",{actionType:"coinGet",coinType:c,balanceNum:k(b),coinNum:k(a),reason:d})},onCoinUse:function(a,b,c,d){t("DE_EVENT_COIN_ACTION",{actionType:"coinUse",coinType:c,balanceNum:k(b),coinNum:k(a),reason:d})},onItemBuy:function(a,b,c,d,e){t("DE_EVENT_ITEM_ACTION",{actionType:"itemBuy",itemId:a,itemNum:k(b),coinType:c,coinNum:k(d),
missonID:e})},onItemProduce:function(a,b,c,d){t("DE_EVENT_ITEM_ACTION",{actionType:"itemGet",itemId:a,itemNum:k(b),missonID:c,reason:d})},onItemUse:function(a,b,c,d){t("DE_EVENT_ITEM_ACTION",{actionType:"itemUse",itemId:a,itemNum:parseInt(b),reason:d,missonID:c})},onLevelUp:function(a,b,c){b=k(b);d.roleLevel=b;t("DE_EVENT_LEVELUP",{startLevel:k(a),endLevel:b,duration:k(c)})},onMissionFinished:function(a,b){t("DE_EVENT_GUANKA_ACTION",{actionType:"guankaFinish",guankaId:a,duration:k(b)})},onMissionUnfinished:function(a,
b){t("DE_EVENT_GUANKA_ACTION",{actionType:"guankaUnfinish",guankaId:a,duration:k(b)})},onPayment:function(a){a&&a.hasOwnProperty("amount")&&ua({data:{paymentInfo:{currencyAmount:parseFloat(a.amount,10)||0,currencyType:a.currencyType||"CNY",payType:String(a.payType||""),iapid:String(a.iapid||""),payTime:k(Date.now()/1E3),extendMap:{orderId:String(a.orderId||"")}}}},ka(wa))},onTaskFinished:function(a,b){t("DE_EVENT_TASK_ACTION",{actionType:"taskFinish",taskId:a,elapsed:k(b)})},onTaskUnfinished:function(a,
b){t("DE_EVENT_TASK_ACTION",{actionType:"taskUnfinish",taskId:a,elapsed:k(b)})},setAccountType:function(a){d.accountType=String(void 0===a?"":a)},setAge:function(a){a=k(a);d.age=0<a&&128>a?a:0},setGameServer:function(a){d.gameServer=String(void 0===a?"":a)},setGender:function(a){d.gender=2===a?2:1},setRoleInfo:Ea},ba=[],Ha;u.player={get isNew(){return d.createTime===d.loginTime},get initTime(){return d.initTime},get createTime(){return d.createTime},get loginTime(){return d.loginTime},get lastLogoutTime(){return k(O(Ca))},
get getReportCount(){return E},get getReportFailedCount(){return K}};u.isReady=function(){return!0===w.inited};var Cb=w.getUserOptions,B,Db=[Ia],Sa=[Ga];for(B in ea)u[B]=ha(ea[B],Db,"onEvent"===B&&Sa);for(B in S)u[B]=ha(S[B],[Fa(B)],"onPayment"!==B&&Sa);var Ta=f.DCAgentObject;if(Ta){var Ua=f[Ta];if(V(Ua)){var fa=Ua.cache;fa.length&&(fa.forEach(function(a){l(u[a[0]],u,[].slice.call(a,1,void 0))}),fa.length=0)}}u.__options=Cb});
